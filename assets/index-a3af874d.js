(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&t(p)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();let L=document.querySelector(".ticketCard");const b=document.querySelector(".searchResult");let i=[];function h(){axios.get("https://raw.githubusercontent.com/hexschool/js-training/main/travelApi.json").then(function(e){i=e.data.data,u(),v()}).catch(function(e){console.log(e)})}h();function u(e="全部地區"){const a=e==="全部地區"?i:i.filter(t=>t.area===e);b.textContent=a.length?`本次搜尋共 ${a.length} 筆資料`:"查無此關鍵字資料";let n="";a.forEach(function(t){n+=`<li class="col-4 mb-9">
      <div class="card border-0 shadow position-relative">
        <span class="tag-l position-absolute top-0 start-0 translate-middle-y bg-secondary fs-5 fw-normal text-white">${t.area}</span>
        <img src="${t.imgUrl}" class="card-img-top mb-1" alt="travel_1" style="height: 180px;">
        <span class="tag-m position-absolute bg-primary fw-normal text-white">${t.rate}</span>
        <div class="d-flex flex-column p-4" style="height: 296px;">
          <h3 class="card-title fs-4 fw-medium text-primary pb-1 border-bottom border-2 border-primary">${t.name}</h3>
          <p class="fw-normal text-info flex-grow-1">${t.description}</p>
          <div class="d-flex justify-content-between">
            <div class="d-flex align-items-center">
              <span class="material-symbols-outlined fs-5 text-primary me-1">
                info
              </span>
              <p class="fw-medium text-primary mb-0">剩下最後 ${t.group} 組</p>
            </div>
            <div class="d-flex align-items-center">
              <span class="fw-medium text-primary me-1">TWD</span>
              <p class="display-8 fw-medium text-primary mb-0">${t.price}</p>
            </div>
          </div>
        </div>
      </div>
    </li>`}),L.innerHTML=n}function v(){let e={};i.forEach(function(t){e[t.area]==null?e[t.area]=1:e[t.area]++}),Object.keys(e).forEach(function(t){let s=[];s.push(t),s.push(e[t])});let n=[["台北",e.台北],["台中",e.台中],["高雄",e.高雄]];c3.generate({bindto:".chart",data:{columns:n,type:"donut",colors:{台北:"#26BFC7",台中:"#5151D3",高雄:"#E68618"}},donut:{title:"套票地區比重"},size:{height:320}})}const y=document.querySelector("#regionSearch");y.addEventListener("change",function(e){u(e.target.value)});const k=document.querySelector(".addTicket"),f=document.querySelector("#ticketName"),l=document.querySelector("#imgUrl"),g=document.querySelector("#sightSpot"),c=document.querySelector("#ticketPrice"),d=document.querySelector("#ticketNum"),m=document.querySelector("#ticketRate"),o=document.querySelector("#ticketDescription");k.addEventListener("click",function(e){let a=i.length,n={};if(n.id=a++,n.name=f.value.trim(),n.imgUrl=l.value.trim(),n.area=g.value.trim(),n.description=o.value.trim(),n.group=Number(d.value.trim()),n.price=Number(c.value.trim()),n.rate=Number(m.value.trim()),Object.values(n).includes(""))alert("每個欄位都為必填！");else{i.push(n);const t=document.querySelector(".addTicketForm");y.value="全部地區",u("全部地區"),t.reset()}u(),v()});f.addEventListener("blur",function(){const e=document.getElementById("ticketName-message");f.value.trim()?e.classList.add("d-none"):(e.classList.remove("d-none"),e.innerHTML=`<span class="material-symbols-outlined me-1">error
    </span><span>必填！</span>`)});l.addEventListener("blur",function(){const e=document.getElementById("imgUrl-message");/^(https?:\/\/)?([\w.-]+\.[a-z]{2,})(\/\S*)?$/i.test(l.value)?e.classList.add("d-none"):l.value.trim()===""?(e.value="",e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>'):(e.value="",e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>請輸入正確網址</span>')});g.addEventListener("blur",function(){const e=document.getElementById("sightSpot-message");g.value?e.classList.add("d-none"):(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>')});c.addEventListener("blur",function(){const e=document.getElementById("ticketPrice-message");/^[1-9]\d*$/.test(c.value)?e.classList.add("d-none"):c.value===""?(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>'):(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>金額需為正整數！</span>')});d.addEventListener("blur",function(){const e=document.getElementById("ticketNum-message");/^[1-9]\d*$/.test(d.value)?e.classList.add("d-none"):d.value===""?(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>'):(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>組數需為正整數！</span>')});m.addEventListener("blur",function(){const e=document.getElementById("ticketRate-message");/^[1-9]\d*$/.test(m.value)?e.classList.add("d-none"):m.value===""?(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>'):(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>請輸入1-10星級整數！</span>')});o.addEventListener("keyup",function(){const e=document.getElementById("ticketDescription-message");/^.{1-100}$/.test(o.value.trim())?e.classList.add("d-none"):o.value.trim()===""?(e.classList.remove("d-none"),e.innerHTML='<span class="material-symbols-outlined me-1">error</span><span>必填！</span>'):(e.classList.remove("d-none"),e.innerHTML=`<span class="material-symbols-outlined me-1">error</span><span>目前可填寫字數${100-o.value.trim().length}個字</span>`)});
